#requirements.txt
snowflake-connector-python
cffi==1.15.0
pyarrow<8.1.0,>=8.0.0
streamlit >= 1.9.2

import streamlit as st
import snowflake.connector

# Recuperar las credenciales de los secretos de Streamlit
snowflake_secrets = st.secrets["snowflake"]
account = snowflake_secrets["account"]
user = snowflake_secrets["user"]
password = snowflake_secrets["password"]
warehouse = snowflake_secrets["warehouse"]
database = snowflake_secrets["database"]
schema = snowflake_secrets["schema"]

# Crear una conexi√≥n a Snowflake
my_cnx = snowflake.connector.connect(
    user=user,
    password=password,
    account=account,
    warehouse=warehouse,
    database=database,
    schema=schema
)

# Crear un cursor para ejecutar consultas
my_cur = my_cnx.cursor()

# Ejecutar una consulta
my_cur.execute("SELECT CURRENT_USER(), CURRENT_ACCOUNT(), CURRENT_REGION()")
my_data_row = my_cur.fetchone()

# Mostrar resultados en Streamlit
st.text("Hello from Snowflake:")
st.text(my_data_row)
